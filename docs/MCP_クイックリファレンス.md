# MCP クイックリファレンス

## 🚀 すぐに使えるコマンド集

### テスト生成 (`haas_jest_tests`)

| コマンド例 | 説明 |
|---------|------|
| `「punch.tsのテストを生成」` | 特定ファイルのユニットテスト作成 |
| `「QRトークン検証のテストを作成」` | 機能別テスト生成 |
| `「カバレッジが50%以下のファイルのテストを追加」` | カバレッジ改善 |
| `「GPSバリデーションの統合テストを作成」` | 統合テスト生成 |
| `「出勤APIのE2Eテストを生成」` | E2Eテスト作成 |

### コード検索 (`haas_navigation`)

| コマンド例 | 説明 |
|---------|------|
| `「GPS検証ロジックを探して」` | GPS関連コードの検索 |
| `「PAスキルの実装を表示」` | 4スキルシステムの検索 |
| `「QRトークン生成の処理を見せて」` | QRトークン関連 |
| `「LINE通知の送信部分を探して」` | LINE統合コード |
| `「出勤記録のスキーマを確認」` | DBスキーマ検索 |

### ビルド・開発 (`haas_build_dev`)

| コマンド例 | 説明 |
|---------|------|
| `「開発サーバーを起動」` | `npm run dev`実行 |
| `「すべてのテストを実行」` | 全テストスイート実行 |
| `「本番ビルドを作成」` | `npm run build`実行 |
| `「型エラーをチェック」` | TypeScriptチェック |
| `「リントエラーを修正」` | ESLint実行と自動修正 |
| `「E2Eテストを実行」` | Playwrightテスト |

### データベース操作 (`haas_supabase_ops`)

| コマンド例 | 説明 |
|---------|------|
| `「今日のQRトークンを確認」` | QRトークンステータス |
| `「会場Aの300m以内の出勤記録」` | GPS検証クエリ |
| `「照明スキルのスタッフ一覧」` | スキル別スタッフ検索 |
| `「今週の割り当て状況」` | シフト割り当て確認 |
| `「テストデータを10件作成」` | テストデータ生成 |

## 🎯 HAAS固有の機能

### 4スキルシステム

```
PA（音響）
音源再生
照明
バックヤード
```

**使用例：**
- `「PAスキルを持つスタッフの稼働率」`
- `「音源再生と照明の両方ができるスタッフ」`
- `「バックヤードの今週の必要人数」`

### GPS出勤検証（300m以内）

**使用例：**
- `「GPS検証の半径を確認」`
- `「会場から離れた打刻記録を探す」`
- `「GPS精度の統計を表示」`

### QRトークンシステム

**使用例：**
- `「期限切れのQRトークンを削除」`
- `「今日発行されたトークン数」`
- `「トークンの有効期限を確認」`

### LINE通知

**使用例：**
- `「LINE通知の送信履歴」`
- `「未確認の割り当て通知」`
- `「通知エラーログを表示」`

## 📝 よく使うワークフロー

### 新機能開発時

1. `「関連するコードを探して」` - 既存実装の確認
2. `「開発サーバーを起動」` - 開発環境準備
3. `「型エラーをチェック」` - 実装中の型確認
4. `「テストを生成」` - ユニットテスト作成
5. `「すべてのテストを実行」` - 動作確認

### バグ修正時

1. `「エラーが発生している部分を探して」` - 問題箇所の特定
2. `「関連するテストを実行」` - 現状確認
3. `「修正後のテストを実行」` - 修正確認
4. `「リグレッションテストを実行」` - 影響範囲確認

### データ確認時

1. `「今日の出勤状況を確認」` - 運用データ確認
2. `「異常なデータを検出」` - データ整合性チェック
3. `「統計情報を表示」` - 分析

## 🔧 npm スクリプト（手動実行用）

```bash
# MCPサーバーの手動起動（デバッグ用）
npm run mcp:jest        # テスト生成サーバー
npm run mcp:nav         # ナビゲーションサーバー
npm run mcp:build       # ビルド・開発サーバー
npm run mcp:supabase    # Supabaseサーバー

# 通常の開発コマンド
npm run dev            # 開発サーバー起動
npm run build          # 本番ビルド
npm run test           # テスト実行
npm run lint           # リンター実行
npm run type-check     # 型チェック
```

## ⚡ ショートカット

### テスト関連
- `「テスト生成」` → 現在のファイルのテスト作成
- `「カバレッジ確認」` → カバレッジレポート表示
- `「失敗テスト」` → 失敗しているテストのリスト

### 開発関連
- `「dev」` → 開発サーバー起動
- `「build」` → ビルド実行
- `「型チェック」` → TypeScript検証

### DB関連
- `「今日のデータ」` → 当日のデータ表示
- `「スキーマ」` → テーブル構造確認
- `「クエリ実行」` → カスタムクエリ

## 🚨 トラブルシューティング

### エラーが出た時

1. `「エラーログを表示」` - エラー内容確認
2. `「関連ファイルを探して」` - 問題箇所特定
3. `「型エラーをチェック」` - 型の問題確認
4. `「依存関係を確認」` - パッケージ確認

### パフォーマンス問題

1. `「ビルド時間を分析」` - ボトルネック特定
2. `「バンドルサイズを確認」` - サイズ最適化
3. `「遅いクエリを検出」` - DB最適化

## 📚 関連ドキュメント

- [MCP セットアップガイド](./MCP_セットアップガイド.md)
- [HAAS プロジェクト概要](../README.md)
- [API ドキュメント](../docs/api.md)
- [データベーススキーマ](../supabase/migrations/schema.sql)